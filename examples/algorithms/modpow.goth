# Modular exponentiation: base^exp mod m
# Uses: recursive fast exponentiation
# Precondition: exp >= 0, m > 0
# Postcondition: result = base^exp mod m
# Complexity: O(log exp)

# modpow base exp m
# De Bruijn: ₂ = base, ₁ = exp, ₀ = m
╭─ modpow : I64 → I64 → I64 → I64
╰─ if ₁ = 0 then 1
   else if (₁ % 2) = 0
        then (modpow (₂ × ₂ % ₀) (₁ / 2) ₀)
        else (₂ × modpow ₂ (₁ - 1) ₀) % ₀

╭─ main : I64 → I64 → I64 → I64
╰─ modpow ₂ ₁ ₀
