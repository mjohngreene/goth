use "../stdlib/string.goth"
use "../stdlib/prelude.goth"

# From tui.goth
╭─ cursorTo : I → I → ()
│  ◇io
╰─ print (strConcat (strConcat (strConcat (strConcat "\x1b[" (toString ₁)) ";") (toString ₀)) "H")

# Each let shifts indices, so we capture from ₃ each time
# Initial: ₀=ch, ₁=len, ₂=col, ₃=row
╭─ hline : I → I → I → String → ()
│  ◇io
╰─ let row = ₃ in   # captures row; now ₀=row, ₁=ch, ₂=len, ₃=col
   let col = ₃ in   # captures col; now ₀=col, ₁=row, ₂=ch, ₃=len
   let len = ₃ in   # captures len; now ₀=len, ₁=col, ₂=row, ₃=ch
   let ch = ₃ in    # captures ch; now ₀=ch, ₁=len, ₂=col, ₃=row
   let _ = cursorTo row col in
   print (joinStrings (replicate len ch))

╭─ main : () → ()
│  ◇io
╰─ hline 5 10 3 "x"
